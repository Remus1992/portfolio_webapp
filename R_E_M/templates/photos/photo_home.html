{% extends 'base.html' %}

{% load static %}

{% block title %}
    : Photo Home
{% endblock %}

{% block content %}

    <head>
        <link rel="stylesheet" type="text/css" href="{% static 'styles/style.css' %}"/>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    </head>
    <style>

        .container {
            margin: 20px auto;
            text-align: center;
            width: 70%;

        }

        h1, body {
            font-family: 'Alegreya Sans SC', sans-serif;
            font-weight: bold;
        }

        .album_container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }

        .album_set {
            box-shadow: inset 0px 0px 0px 12px;
            position: relative;
            width: 300px;
            height: 300px;
            margin: 5px;

            /* */

            display: block;
            overflow: hidden;
            height: 300px;
            width: 300px;
        }

        .image {
            /**
                opacity: 1;
                display: block;
                height: 300px;
                overflow: hidden;
                transition: .3s ease;
                backface-visibility: hidden;
                position: absolute;
                object-position: center;
                clip: rect(0px, 300px, 300px, 0px);
            **/
            display: block;
            width: 100%;
            height: 100%;
            background-position: center center;
            background-size: cover;

        }

        .middle {
            transition: .5s ease;
            opacity: 0;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            -ms-transform: translate(-50%, -50%);
            text-align: center;
        }

        .album_set:hover .image {
            opacity: 0.3;
            -webkit-filter: blur(2px); /* Safari 6.0 - 9.0 */
            filter: blur(2px);

        }

        .album_set:hover .middle {
            opacity: 1;

        }

        .album_set:hover {
        }

        .text {
        {#font-size: 1.5vw;#}{#color: black;#}
        }

        .category_container {
            height: 20px;
            padding: 20px;
        }

        a:visited {
            color: black;
        }

        /* ***** text animation ****** */

        .album_set:hover .text_bottom {
            /* Apply animation to this element */
            animation: text_bottom 0.3s ease-out;
        }

        /* Move it (define the animation) */
        @keyframes text_bottom {
            0% {
                transform: translateY(300%);
            }
            100% {
                transform: translateY(0%);
            }
        }

        .album_set:hover .text_top {
            /* Apply animation to this element */
            animation: text_top 0.3s ease-out;
        }

        /* Move it (define the animation) */
        @keyframes text_top {
            0% {
                transform: translateY(-300%);
            }
            100% {
                transform: translateY(0%);
            }
        }

        /** JQUERY NEW SET **/

        .album-image {
            visibility: hidden;
        }

        /* prevent a flash of giant image before the image is wrapped by jQuery */

        .album-image-wrap {
            /* whatever the dimensions you want the "cropped" image to be */
            height: 300px;
            width: 300px;
            overflow: hidden;
        }

        .album-image-wrap img.square {
            visibility: visible;
            width: 100%;
        }

        .album-image-wrap img.portrait {
            visibility: visible;
            width: 100%;
            height: auto;
        }

        .album-image-wrap img.landscape {
            visibility: visible;
            height: 100%;
            width: auto;
        }
    </style>
    <div class="page_container">
        <div class="container">

            <h1>Photo Home</h1>
            <a href="{% url 'picture_upload' %}">Upload</a>
            <br>
            <br>
            <div class="album_container">
                {% for cat in album_cats %}

                    {% for album in albums %}
                        {% if album.category == cat %}
                            <a href="{% url 'album_view' album.category.slug album.slug %}" class="text">
                                <div class="album_set">
                                    <img src="{{ album.photo_album.all.0.image.url }}" class="album-image"
                                            {#  class="image"#}
                                         alt="{{ album.photo_album.all.0.image }}">
                                    <div class="middle">
                                        <div class="text text_top">{{ album.title }}</div>
                                        <div class="text text_center">
                                            <hr>
                                        </div>
                                        <div class="text text_bottom">{{ album.album_details }}</div>
                                    </div>
                                </div>
                            </a>
                        {% endif %}
                    {% endfor %}

                {% endfor %}
            </div>
            <!--
            {% for cat in album_cats %}
                <div class="category_container">
                    <h1>-------- {{ cat.name }} --------</h1>
                </div>
                <div class="album_container">
                    {% for album in albums %}
                        {% if album.category == cat %}
                            <a href="{% url 'album_view' album.category.slug album.slug %}" class="text">
                                <div class="album_set">
                                    <img src="{{ album.photo_album.all.0.image.url }}" class="image"
                                         alt="{{ album.photo_album.all.0. }}">
                                    <div class="middle">
                                        <div class="text text_top">{{ album.title }}</div>
                                        <div class="text text_center">
                                            <hr>
                                        </div>
                                        <div class="text text_bottom">{{ album.album_details }}</div>
                                    </div>
                                </div>
                            </a>
                        {% endif %}
                    {% endfor %}
                </div>
            {% endfor %}
-->
        </div>
    </div>

    <script>
        cropAlbumImage = function (pic) {
            let h = $(pic).height();
            let w = $(pic).width();

            console.log(h);
            console.log(w);

            if ($(pic).parent('.album-image-wrap').length === 0) {
                // wrap the image in a "cropping" div
                $(pic).wrap('<div class="album-image-wrap"></div>');
            }

            if (h > w) {
                // pic is portrait
                $(pic).addClass('portrait');
                let m = -(((h / w) * 100) - 100) / 2; //math the negative margin
                $(pic).css('margin-top', m + '%');
            } else if (w > h) {
                // pic is landscape
                $(pic).addClass('landscape');
                let m = -(((w / h) * 100) - 100) / 2;  //math the negative margin
                $(pic).css('margin-left', m + '%');
            } else {
                // pic is square
                $(pic).addClass('square');
            }
        };


        {#let number_of_albums = $('.album_set').length;#}
        {#console.log(number_of_albums);#}

        //for (i = 0; i < $('.album_set').length; i++) {
            // Call the function for the images you want to crop
            //cropAlbumImage('img.album-image');
        //}


        $(document).ready(function () {
            $('img.album-image').each(function () {
                let h = $(this).height();
                let w = $(this).width();

                console.log(h);
                console.log(w);

                if ($(this).parent('.album-image-wrap').length === 0) {
                    // wrap the image in a "cropping" div
                    $(this).wrap('<div class="album-image-wrap"></div>');
                }

                if (h > w) {
                    // pic is portrait
                    $(this).addClass('portrait');
                    let m = -(((h / w) * 100) - 100) / 2; //math the negative margin
                    $(this).css('margin-top', m + '%');
                } else if (w > h) {
                    // pic is landscape
                    $(this).addClass('landscape');
                    let m = -(((w / h) * 100) - 100) / 2;  //math the negative margin
                    $(this).css('margin-left', m + '%');
                } else {
                    // pic is square
                    $(this).addClass('square');
                }
            })
        });

    </script>
{% endblock %}


{% block footer %}
    {% include 'footer_base.html' %}
{% endblock %}