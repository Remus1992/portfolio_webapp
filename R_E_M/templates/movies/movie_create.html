{% extends 'base.html' %}

{% load static %}

{% block title %}
    : About
{% endblock %}

{% block content %}
   <head>
        <link rel="stylesheet" type="text/css" href="{% static 'styles/photography_upload_style.css' %}"/>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    </head>

    <style>
        .row {
            margin: 50px;
            border-style: solid;
            border-width: 5px;
            padding: 10px;
        }
    </style>
    <h1>Movie Create</h1>
    <div class="row">
        <section class="create">
            <form class="blog_create" method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <p>Movie Title</p>
                <input type="text" id="movie_title" name="movie_title">
                <p>Movie Tagline</p>
                <input type="text" id="movie_tag" name="movie_tag">
                <p>Category</p>
                <input list="categories" id="movie_category" name="movie_category">

                <datalist id="categories">
                    {% for c in cat %}
                        <option value="{{ c.name }}">
                    {% endfor %}
                </datalist>
                <br>
                <p>Movie Details</p>
                <textarea id="movie_details" name="movie_details" cols="30" rows="10"></textarea>
                <br>
                <p>Movie Date</p>
                <input type="date" id="movie_date" name="movie_date">
                <br>
                <p>Movie Poster</p>
                <input type="file" id="movie_poster" name="movie_poster">
                <br>
                <p>Image Alt Text</p>
                <input type="text" id="alt_text" name="alt_text">
                <br>
                <p>Movie Script</p>
                <input type="file" id="movie_script" name="movie_script">
                <br>
                <p>YouTube Link</p>
                <input type="text" id="youtube_link" name="movie_youtube">
                <br>
                <input class='btn' name="images" type="file" multiple id="gallery-photo-add">
                <div class="gallery">

                </div>
                <input class="button" type="submit" value="Submit" id="sub-btn">
            </form>
        </section>
    </div>

    <script>
        let imagesPreview = function (input, placeToInsertImagePreview) {
            $(placeToInsertImagePreview).html('');

            if (input.files) {
                let filesAmount = input.files.length;

                for (let i = 0; i < filesAmount; i++) {
                    let reader = new FileReader();
                    let num = i;
                    let name = input.files[i].name;
                    reader.onload = function (event) {
                        let html = $('<div class="img_holder" id="image_${num + 1}"></div>', {
                            'id': `image_div_${num + 1}`
                        })
                            .append($(`<input>`).attr({
                                'type': 'hidden',
                                'value': event.target.result,
                                'name': `image_${num + 1}`
                            }))
                            .append($(`<p>${name}</p><img class="image" src="${event.target.result}" id="new_picture_${num + 1}"><div><label for="image_name_${num + 1}">Photo Title</label></div><div><input type="text" name="image_name_${num + 1}"></div><div><label for="alt_text_${num + 1}">Alt Text</label></div><div><input type="text" id="alt_text_${num + 1}" name="alt_text_${num + 1}"></div><div><label for="creation_date_${num + 1}">Date Taken</label></div><div><input type="date" id="creation_date_${num + 1}" name="creation_date_${num + 1}"></div><div><label for="image_details_${num + 1}">Image Details</label></div><div><input type="text" id="image_details_${num + 1}" name="image_details_${num + 1}"></div>`));
                        $(placeToInsertImagePreview).append(html);
                    };

                    reader.readAsDataURL(input.files[i]);
                }
            }
            input.value = ''
        };
        $('#gallery-photo-add').on('change', function () {
            imagesPreview(this, 'div.gallery');
        });
    </script>
{% endblock %}